# Imath package Makevars
CMAKE = /usr/local/Cellar/cmake/3.24.2/bin/cmake

# Directories
IMATH_DIR = /Users/tyler/Desktop/R/static_packages/libimath
INST_DIR = /Users/tyler/Desktop/R/static_packages/libimath/inst
LIB_DIR = /Users/tyler/Desktop/R/static_packages/libimath/inst/lib/arm64
INCLUDE_DIR = /Users/tyler/Desktop/R/static_packages/libimath/inst/include

IMATH_LIB = $(LIB_DIR)/libImath-3_2.a

# Static libraries we need to link against
# Note that we're using the version suffix pattern that Imath actually creates
PKG_LIBS = -L$(LIB_DIR) -lImath-3_2
PKG_CXXFLAGS = -I$(INCLUDE_DIR) -I/Users/tyler/Desktop/R/static_packages/libimath/include
PKG_CFLAGS = -I$(INCLUDE_DIR) -I/Users/tyler/Desktop/R/static_packages/libimath/include

# Required for linking with static libraries
CFLAGS = $(CFLAGS) $(CPICFLAGS)
CXXFLAGS = $(CXXFLAGS) $(CXXPICFLAGS)

# Main target
all: $(OBJECTS)

$(OBJECTS): $(IMATH_LIB)

$(IMATH_LIB):
	cd /Users/tyler/Desktop/R/static_packages/libimath/src/Imath/build && /usr/local/Cellar/cmake/3.24.2/bin/cmake --build . --config Release
	cd /Users/tyler/Desktop/R/static_packages/libimath/src/Imath/build && /usr/local/Cellar/cmake/3.24.2/bin/cmake --install . --config Release
	cd /Users/tyler/Desktop/R/static_packages/libimath && \
	"$(R_HOME)/bin/Rscript" tools/fix-line-endings.R src/Imath/build/Makefile \
    src/Imath/build/config/Makefile \
    src/Imath/build/src/Imath/Makefile \
    src/Makevars \
	src/Imath/build/CMakeFiles/3.30.4/CompilerIdC/CMakeCCompilerId.c \
    src/Imath/build/CMakeFiles/3.30.4/CompilerIdCXX/CMakeCXXCompilerId.cpp \
    src/Imath/build/config/ImathConfig.h \
    inst/include/Imath/ImathConfig.h

clean: 
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/src/Imath/build && \
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/src/Makevars && \
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/src/Makevars.win && \
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/config.log && \
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/config.status && \
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/autom4te.cache && \
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/configure~
	rm -rf /Users/tyler/Desktop/R/static_packages/libimath/tools
